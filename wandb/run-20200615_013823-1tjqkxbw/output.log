Vocabluary size: 39
==================================================
|                    Training                    |
==================================================
Epoch Size=  8

***batch_idx -- n workers***: 2
torch.Size([17259])
<class 'compressor.topk.TopKCompressor'>
<class 'tuple'>
<class 'tuple'>
(17259, torch.Size([17259]))
(tensor([-0.1588, -0.0785, -0.0643, -0.0370,  0.0339, -0.0309, -0.0308, -0.0282,
         0.0265, -0.0204,  0.0182, -0.0179,  0.0177,  0.0173, -0.0172,  0.0172,
        -0.0172, -0.0171,  0.0170,  0.0170,  0.0170,  0.0170,  0.0170, -0.0168,
         0.0168,  0.0168,  0.0168,  0.0168, -0.0167,  0.0167,  0.0167, -0.0167,
         0.0166, -0.0166,  0.0166,  0.0165,  0.0165,  0.0165,  0.0165,  0.0165,
         0.0165,  0.0164,  0.0164,  0.0164,  0.0164,  0.0164,  0.0163,  0.0163,
         0.0162,  0.0162,  0.0159, -0.0153, -0.0153, -0.0152, -0.0149, -0.0145,
         0.0143,  0.0143,  0.0143,  0.0139,  0.0136, -0.0135, -0.0135,  0.0135,
         0.0131,  0.0124,  0.0124,  0.0123, -0.0119,  0.0119,  0.0117, -0.0117,
         0.0115,  0.0111, -0.0111, -0.0111,  0.0101,  0.0101,  0.0100, -0.0098,
        -0.0098, -0.0097,  0.0093,  0.0086, -0.0084, -0.0084, -0.0080,  0.0080,
         0.0076,  0.0074, -0.0073,  0.0072,  0.0072,  0.0071,  0.0070,  0.0069,
         0.0069,  0.0068,  0.0067, -0.0066, -0.0064, -0.0064, -0.0064, -0.0062,
        -0.0061,  0.0060,  0.0059, -0.0057, -0.0056, -0.0056,  0.0054, -0.0054,
         0.0049,  0.0049,  0.0049,  0.0049,  0.0049, -0.0048, -0.0048,  0.0048,
         0.0047,  0.0046,  0.0046, -0.0044,  0.0043,  0.0042,  0.0041,  0.0041,
         0.0041, -0.0040,  0.0040,  0.0040, -0.0038, -0.0038, -0.0037,  0.0037,
         0.0035,  0.0035,  0.0035,  0.0035, -0.0035, -0.0035, -0.0035,  0.0034,
        -0.0033, -0.0033,  0.0033, -0.0031, -0.0031,  0.0031, -0.0031,  0.0031,
        -0.0030, -0.0029, -0.0029,  0.0029,  0.0029,  0.0029, -0.0029, -0.0029,
         0.0028,  0.0028, -0.0028, -0.0028,  0.0028,  0.0028,  0.0028, -0.0026,
        -0.0026,  0.0026,  0.0026,  0.0025]), tensor([17220, 17223, 17221, 16050, 16078, 17230, 17235, 16071, 16057, 16077,
        16145, 16062, 16055, 16149, 17226, 17229, 16152, 17251, 17246, 17239,
        17240, 17224, 17249, 17222, 17241, 17236, 17255, 16164, 17243, 17234,
        17238, 17256, 17247, 17254, 17228, 17252, 17248, 17253, 17244, 17242,
        17245, 17232, 17231, 17233, 17227, 16108, 17237, 17225, 17257, 17258,
        17250, 16018, 15898, 16500, 16165, 16140, 15884, 16004, 16068, 16058,
        16060, 15888, 16008, 16089, 16147, 15889, 16009, 16093, 16167, 16104,
        16059, 16064, 16168, 16148, 16011, 15891, 16360, 16509, 16355, 16001,
        15881, 16101, 16074, 16507, 15877, 15997, 16375, 16063, 16359, 16513,
        16107, 16010, 15890, 16150, 16153, 16363, 16768, 16368, 16258, 16070,
        16230, 15894, 16014, 16075, 16161, 17075, 16053, 16364, 16527, 16377,
        16508, 16514, 15994, 15874, 16006, 15886, 16745, 16094, 16052, 16506,
        16158, 16086, 16240, 17091, 16143, 16051, 16243, 16372, 17083, 16163,
        16003, 15883, 16013, 15893, 16255, 16750, 17143, 17140, 16048, 15928,
        16980, 15887, 16007, 16749, 16370, 16100, 16081, 16761, 16061, 17008,
        16066, 16522, 16110, 15875, 15995, 16072, 16069, 16159, 16017, 15897,
        15999, 15879,  8574,  8454, 16993, 16747, 16529,  8579,  8459, 16162,
        16236, 16320]))

***batch_idx -- n workers***: 4
torch.Size([17259])
<class 'compressor.topk.TopKCompressor'>
<class 'tuple'>
<class 'tuple'>
(17259, torch.Size([17259]))
(tensor([-0.1010, -0.0825, -0.0424, -0.0424, -0.0420, -0.0408, -0.0407, -0.0354,
         0.0330,  0.0304, -0.0227,  0.0223,  0.0222,  0.0221,  0.0221,  0.0221,
         0.0219,  0.0218,  0.0217,  0.0217,  0.0217,  0.0216,  0.0216,  0.0212,
         0.0212,  0.0211,  0.0211,  0.0211,  0.0210,  0.0210,  0.0208,  0.0208,
         0.0207,  0.0207, -0.0207, -0.0206, -0.0204,  0.0204,  0.0204,  0.0204,
        -0.0203, -0.0200, -0.0200, -0.0199,  0.0199, -0.0198, -0.0197, -0.0195,
        -0.0189, -0.0176,  0.0170,  0.0170,  0.0160,  0.0158,  0.0158,  0.0157,
        -0.0156, -0.0152, -0.0152, -0.0147,  0.0146,  0.0146,  0.0139,  0.0138,
         0.0138,  0.0138, -0.0137, -0.0134,  0.0134,  0.0131, -0.0128,  0.0126,
         0.0124,  0.0124, -0.0120,  0.0118,  0.0118,  0.0113,  0.0112, -0.0112,
        -0.0112,  0.0111,  0.0110, -0.0109, -0.0109, -0.0109,  0.0108,  0.0104,
         0.0103, -0.0099,  0.0098, -0.0098,  0.0096, -0.0095, -0.0095,  0.0093,
         0.0089,  0.0089,  0.0088,  0.0086, -0.0086,  0.0084, -0.0084,  0.0083,
         0.0083,  0.0083,  0.0083, -0.0083,  0.0083,  0.0082,  0.0082,  0.0081,
         0.0078,  0.0077,  0.0076,  0.0076,  0.0075, -0.0075, -0.0075, -0.0075,
         0.0075,  0.0075,  0.0074,  0.0074,  0.0074, -0.0074,  0.0072,  0.0071,
         0.0071,  0.0070,  0.0069, -0.0069, -0.0068, -0.0067, -0.0067, -0.0066,
        -0.0066,  0.0066,  0.0066,  0.0065, -0.0063, -0.0060,  0.0060,  0.0059,
         0.0059,  0.0059,  0.0058,  0.0058, -0.0058,  0.0057,  0.0057,  0.0056,
        -0.0055, -0.0055,  0.0055, -0.0054, -0.0054, -0.0054, -0.0054, -0.0053,
        -0.0053, -0.0053, -0.0053, -0.0053, -0.0053, -0.0053,  0.0052, -0.0052,
        -0.0052,  0.0052, -0.0051, -0.0051]), tensor([17220, 17222, 17242, 17226, 17255, 17223, 17221, 16110, 16078, 16074,
        16062, 17254, 17235, 16058, 17229, 17243, 17256, 17239, 17230, 17246,
        17240, 17249, 17251, 17241, 17236, 17238, 17247, 17252, 17248, 17231,
        17253, 17233, 16134, 17227, 16230, 16140, 17225, 17237, 17232, 17258,
        17257, 17244, 17245, 17228, 17250, 17234, 16122, 17224, 16050, 17121,
        16063, 16108, 16138, 16738, 16150, 16258, 16137, 15898, 16018, 16251,
        17128, 16128, 17109, 16168, 16072, 16164, 16105, 16731, 16734, 17124,
        16071, 16149, 16059, 16060, 16290, 16090, 16719, 16235, 16237, 16770,
        16152, 16089, 16087, 16470, 16107, 16800, 16088, 16239, 16055, 16167,
        16057, 16821, 17105, 15991, 15871, 17108, 16098, 16147, 16810, 16111,
        16257, 16780, 17185, 15886, 16006, 15874, 15994, 17181, 16175, 17107,
        16123, 16194, 16300, 17113, 16198, 16498, 16318, 16135, 16244, 16225,
        16079, 16479, 15996, 15876, 16794, 16315, 16120, 16243, 16153, 16210,
        16093, 16232, 16782, 16064, 16827, 16182, 16317, 17165, 16252, 16779,
        16812, 16052, 16783, 16805, 15889, 16009, 15887, 16007, 16227, 16183,
        16483, 16141, 15897, 16017, 16477, 17098, 16348, 16061, 16768, 16528,
        16858, 16497, 17158, 16648, 16678, 16378, 16788, 17008, 16948, 16297,
        16558, 16708]))

***batch_idx -- n workers***: 6
torch.Size([17259])
<class 'compressor.topk.TopKCompressor'>
<class 'tuple'>
<class 'tuple'>
(17259, torch.Size([17259]))
(tensor([-0.1223, -0.0972, -0.0680, -0.0419, -0.0417, -0.0415, -0.0412,  0.0305,
        -0.0265, -0.0260,  0.0234, -0.0229,  0.0217, -0.0214,  0.0213, -0.0206,
         0.0201,  0.0199,  0.0189,  0.0189,  0.0184,  0.0183,  0.0183,  0.0183,
         0.0183,  0.0183,  0.0182,  0.0182,  0.0181,  0.0181,  0.0180,  0.0178,
         0.0178,  0.0178,  0.0178,  0.0177,  0.0177,  0.0175,  0.0173,  0.0172,
         0.0171,  0.0171,  0.0171,  0.0169,  0.0169,  0.0167,  0.0167, -0.0158,
        -0.0152,  0.0151,  0.0150,  0.0141,  0.0141, -0.0137,  0.0136,  0.0135,
         0.0130,  0.0129,  0.0128, -0.0125, -0.0124, -0.0121, -0.0120, -0.0115,
         0.0115, -0.0114, -0.0113, -0.0111, -0.0110,  0.0109, -0.0108,  0.0105,
         0.0105,  0.0104,  0.0103,  0.0100, -0.0097, -0.0094, -0.0093,  0.0093,
        -0.0091, -0.0090,  0.0090,  0.0090,  0.0088, -0.0087, -0.0086, -0.0086,
         0.0085,  0.0082,  0.0081,  0.0080,  0.0080, -0.0079, -0.0078, -0.0077,
        -0.0077,  0.0075,  0.0074,  0.0072, -0.0071,  0.0070, -0.0068,  0.0068,
        -0.0066, -0.0066,  0.0066,  0.0065,  0.0065,  0.0065, -0.0065, -0.0064,
         0.0063,  0.0062,  0.0061,  0.0061, -0.0060,  0.0059, -0.0059,  0.0058,
        -0.0057,  0.0056,  0.0056,  0.0056,  0.0055,  0.0055,  0.0055,  0.0055,
        -0.0055, -0.0054, -0.0054,  0.0054, -0.0053,  0.0053,  0.0053, -0.0053,
        -0.0052,  0.0051,  0.0051,  0.0051,  0.0051,  0.0051,  0.0050,  0.0050,
        -0.0049, -0.0049,  0.0048,  0.0048,  0.0048, -0.0048,  0.0047,  0.0047,
         0.0047, -0.0046,  0.0046,  0.0045,  0.0045,  0.0045,  0.0045, -0.0045,
        -0.0045,  0.0045,  0.0044,  0.0044,  0.0043,  0.0043, -0.0043, -0.0042,
        -0.0042,  0.0042,  0.0042, -0.0041]), tensor([17220, 17222, 17221, 17227, 17238, 17236, 17246, 16138, 16071, 16101,
        16119, 16590, 16059, 16110, 16060, 16830, 16117, 16063, 17255, 17226,
        17242, 17244, 17243, 17234, 17254, 17235, 17245, 17228, 17229, 17230,
        17256, 17247, 17251, 17240, 17249, 17225, 17257, 17239, 17241, 16540,
        17248, 17233, 17237, 17253, 17232, 17258, 17250, 16105, 16611, 16088,
        16288, 16128, 16104, 16062, 16284, 16558, 16134, 16614, 16132, 16075,
        16281, 17252, 17231, 16285, 16539, 16855, 16857, 16287, 17224, 16085,
        16557, 16599, 16055, 16598, 16267, 16089, 16617, 16380, 16542, 16116,
        17010, 17223, 16843, 16538, 16056, 16094, 16007, 15887, 16118, 16072,
        16058, 15992, 15872, 16602, 16064, 16080, 16050, 16069, 16093, 16198,
        16122, 16603, 16092, 16067, 16011, 15891, 16150, 15897, 16017, 16090,
        16274, 16130, 16852, 16404, 16113, 16068, 16544, 16548, 16161, 16081,
        16601, 16612, 16180, 16164, 16390, 16006, 15886, 17020, 16610, 16014,
        15894, 16282, 16052, 16004, 15884, 17031, 16121, 16012, 15892, 15889,
        16009, 16277, 16078, 16591, 16091, 16112, 17015, 16139, 16111, 16073,
        15993, 15873, 16387, 16405, 16074, 16536, 15876, 15996, 17023, 15881,
        16001, 16389, 16393, 16547, 16531, 16279, 16082, 16061, 16066, 17034,
        16552, 16100]))

***batch_idx -- n workers***: 8
torch.Size([17259])
<class 'compressor.topk.TopKCompressor'>
<class 'tuple'>
<class 'tuple'>
(17259, torch.Size([17259]))
(tensor([-0.1071, -0.0786, -0.0457, -0.0451, -0.0448, -0.0444, -0.0436, -0.0434,
        -0.0338,  0.0273,  0.0273,  0.0217,  0.0217,  0.0215,  0.0215,  0.0214,
         0.0212,  0.0212,  0.0212,  0.0211,  0.0211,  0.0211,  0.0211,  0.0210,
         0.0210,  0.0210,  0.0208,  0.0208,  0.0206,  0.0206,  0.0206, -0.0205,
         0.0205,  0.0204,  0.0203,  0.0201,  0.0200,  0.0198, -0.0196,  0.0195,
        -0.0195, -0.0195, -0.0191,  0.0190, -0.0187, -0.0185, -0.0181,  0.0176,
         0.0174,  0.0168, -0.0166,  0.0166, -0.0161,  0.0160, -0.0154, -0.0153,
        -0.0153,  0.0147, -0.0147, -0.0145, -0.0136,  0.0134,  0.0134,  0.0134,
         0.0132, -0.0132,  0.0129,  0.0129,  0.0128,  0.0122, -0.0119, -0.0119,
         0.0118,  0.0118,  0.0117, -0.0116,  0.0114,  0.0114,  0.0111,  0.0110,
         0.0108,  0.0108, -0.0106, -0.0105,  0.0105,  0.0101,  0.0100,  0.0100,
         0.0098,  0.0095,  0.0095, -0.0095,  0.0094, -0.0091, -0.0091, -0.0091,
         0.0087,  0.0087, -0.0087,  0.0086, -0.0086,  0.0085,  0.0085, -0.0082,
         0.0082,  0.0081,  0.0081,  0.0081,  0.0081, -0.0078, -0.0077, -0.0077,
         0.0077, -0.0076, -0.0076, -0.0073, -0.0073,  0.0073,  0.0073,  0.0073,
         0.0072, -0.0071,  0.0070, -0.0070, -0.0067, -0.0067,  0.0066,  0.0066,
         0.0066,  0.0065, -0.0065,  0.0065, -0.0062,  0.0061,  0.0061, -0.0061,
        -0.0061,  0.0060,  0.0060, -0.0059,  0.0058,  0.0056, -0.0055, -0.0055,
        -0.0054, -0.0053,  0.0053, -0.0053,  0.0052, -0.0052, -0.0051, -0.0049,
         0.0049,  0.0049, -0.0049,  0.0048,  0.0048,  0.0048,  0.0048,  0.0048,
         0.0048,  0.0048,  0.0048, -0.0047, -0.0047, -0.0047,  0.0047,  0.0047,
         0.0047,  0.0047,  0.0047,  0.0047]), tensor([17223, 17221, 17237, 17225, 17249, 17227, 17224, 17220, 16165, 17222,
        16108, 17246, 17236, 17255, 17226, 17242, 16104, 17238, 17228, 17234,
        17243, 17235, 17230, 17231, 17256, 17244, 17254, 17247, 17252, 17240,
        17245, 16152, 17251, 17257, 16570, 17241, 16089, 17250, 17253, 17233,
        16105, 17232, 17248, 17258, 17239, 16941, 17229, 16930, 16270, 16210,
        16281, 16158, 16092, 16162, 16410, 16890, 16221, 16168, 16161, 16101,
        16191, 16164, 16265, 16925, 16565, 16195, 16194, 16284, 16175, 16929,
        16585, 16285, 16269, 16568, 16569, 16225, 16224, 16179, 16149, 16208,
        16087, 16153, 16947, 16932, 16088, 17050, 16928, 16567, 16148, 16005,
        15885, 16212, 16933, 16167, 16007, 15887, 16630, 16927, 16197, 16178,
        17061, 16098, 16438, 16341, 16348, 16192, 16648, 15995, 15875, 16061,
        15888, 16008, 16078, 15998, 15878, 15880, 16000, 16344, 15886, 16006,
        16329, 17067, 16942, 16911, 16934, 16641, 16146, 16629, 16085, 17053,
        16571, 16051, 16574, 15871, 15991, 16018, 15898, 16131, 16895, 16345,
        16109, 16566, 16071, 16075, 16077, 17052, 16074, 16059, 17049, 16107,
        16580, 16917, 16338, 16561, 16262, 16418, 16057, 16135, 16251, 16851,
        16551, 15884, 16004, 15895, 16015, 16931, 17121, 16731, 16638, 16898,
        16055, 16371]))
Train perplexity at epoch 0:    37.58
Epoch Size=  8
Validation perplexity at epoch 0:    33.41
==================================================
|                    Testing                     |
==================================================
Epoch Size=  36
Test Perplexity:    34.24

======================== Done! ========================
